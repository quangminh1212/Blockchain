7. Software Components

    Tổ chức Lớp ASW
        . Lớp ASW trong Autosar được tổ chức thành các đơn vị phần mềm tự chứa gọi là các loại thành phần phần mềm nguyên tử.
        . Một loại thành phần phần mềm nguyên tử đại diện cho một triển khai chức năng của ứng dụng.
        . Tập hợp các thành phần phần mềm nhỏ này tạo nên toàn bộ triển khai chức năng của hệ thống.

    . Các Loại Thành phần Phần mềm
    
        . Thành phần phần mềm ứng dụng (Application Software Component)
            . Giữ các chức năng của phần mềm như tính toán, ra quyết định.
            . Ví dụ: Thuật toán để quyết định khi nào dừng và khởi động xe tự động.

        . Thành phần phần mềm khối NV (NV Block Software Component)
            . Sử dụng khi cần lưu thông tin quan trọng trong bộ nhớ phần cứng để tái sử dụng trong tương lai.
            . Ví dụ: Lưu tổng số km xe đã đi và khôi phục lại khi khởi động xe.

        . Trình điều khiển thiết bị phức tạp (Complex Device Driver - CDD)
            . Sử dụng khi ứng dụng cần truy cập phần cứng một cách nhanh chóng, giảm thiểu thời gian trễ qua các lớp phần mềm khác.
            . Ví dụ: Kích hoạt túi khí, kim phun nhiên liệu.

        . Thành phần dịch vụ (Service Component)
            . Cung cấp dịch vụ từ phần mềm cơ bản cho lớp ứng dụng.
            . Ví dụ: Quản lý trạng thái ECU, quản lý sự kiện chẩn đoán.

        . Thành phần proxy dịch vụ (Service Proxy Component)
            . Sử dụng khi cần truy cập dịch vụ từ một ECU khác.

        . Thành phần phần mềm trừu tượng hóa ECU (ECU Abstraction Software Component)
            . Truy cập và giao tiếp giữa lớp MCAL và lớp ứng dụng.
            . Ví dụ: Viết trình điều khiển cho các thiết bị ngoại vi như IC H-Bridge, IC giai đoạn nguồn.

        . Thành phần phần mềm cảm biến/thiết bị chấp hành (Sensor Actuator Software Component)
            . Chuyển đổi dữ liệu cảm biến từ dữ liệu thô và điều khiển thiết bị chấp hành dựa trên lệnh đầu vào từ ứng dụng.

        . Thành phần phần mềm tham số (Parameter Software Component)
            . Cung cấp các thông số hiệu chỉnh cho dự án, không có file C liên kết và chỉ là cấu hình.
            . Ví dụ: Hiệu chỉnh giá trị cắt ánh sáng để bật đèn pha tự động.

        . Thành phần phần mềm hợp thành (Composition Software Component)
            . Là các container chứa tập hợp các thành phần phần mềm dựa trên chức năng.
            . Không có file C riêng nhưng có cấu hình quan trọng của các thành phần mà nó chứa và giao tiếp giữa chúng.

    . Lưu ý
        . Thành phần phần mềm tham số không có file C liên kết và chỉ cung cấp hiệu chỉnh.
        . Tất cả thông tin phải được truyền qua RTE ngay cả khi ứng dụng có yêu cầu thời gian quan trọng.
        . Sẽ thấy chi tiết về thành phần phần mềm hợp thành sau, cùng với cấu hình Kết nối mà nó có.

    . Tóm tắt
        . Các thành phần phần mềm ứng dụng trong lớp ASW của Autosar được phân loại thành nhiều loại dựa trên chức năng cụ thể.
        . Các thành phần này giúp tạo nên một hệ thống phần mềm ứng dụng linh hoạt, có thể tái sử dụng và dễ dàng phát triển.
        . Sự phân loại và cấu trúc này giúp tách biệt rõ ràng giữa phần mềm ứng dụng và phần mềm cơ bản, tối ưu hóa phát triển phần mềm ô tô.


8. Software Components (Example)
    . Yêu cầu Sử dụng
        . Nhận tốc độ xe từ cảm biến tốc độ ngoài.
        . Nếu tốc độ vượt quá giá trị cài đặt, thực hiện các hành động sau:
        . Cắt nhiên liệu ngay lập tức và dừng xe.
        . Ghi lỗi thông qua module chẩn đoán.
        . Tính toán tốc độ tối đa của xe và lưu dữ liệu trong quá trình tắt máy.
        . Khôi phục dữ liệu khi ECU khởi động lại trong chu kỳ lái xe tiếp theo.

    . Thiết kế Giải pháp Autosar
        . Nhận Dữ liệu từ Cảm biến Tốc độ
            . Cảm biến tốc độ kết nối với ECU, đầu vào cảm biến có sẵn trên chân IO kỹ thuật số của bộ điều khiển.
            . Thành phần trừu tượng hóa ECU (ECU abstraction software component) đọc chân IO tương ứng và tính toán thông tin xung nhịp từ cảm biến tốc độ.

        . Xử lý Dữ liệu Cảm biến
            . Thành phần phần mềm cảm biến/thiết bị chấp hành (sensor actuator software component) tương tác với lớp trừu tượng hóa ECU để nhận xung nhịp cảm biến.
            . Tính toán tốc độ dựa trên đầu vào cảm biến và chuyển đổi đơn vị tốc độ như km/h, m/h.

        . Logic Cắt Động cơ
            . Thành phần phần mềm ứng dụng (application software component) thực hiện logic chính để cắt động cơ khi vượt quá tốc độ.
            . Nhận tốc độ đã tính toán từ thành phần cảm biến/thiết bị chấp hành và xử lý tiếp.

        . Tham số Hiệu chỉnh
            . Thành phần phần mềm tham số (parameter software component) cung cấp tham số hiệu chỉnh để quyết định giá trị cắt tốc độ cao.
            . Tham số này có thể điều chỉnh trong quá trình sản xuất.

        . Cắt Nhiên liệu Ngay lập tức
            . Trình điều khiển thiết bị phức tạp (Complex Device Driver - CDD) thực hiện lệnh cắt nhiên liệu từ ứng dụng và thiết lập chân IO của bộ điều khiển để cắt nhiên liệu ngay lập tức.

        . Ghi Lỗi Chẩn đoán
            . Thành phần phần mềm dịch vụ (BSW service software component) cho chẩn đoán để ghi lỗi.
            . Thành phần ứng dụng kết nối với thành phần dịch vụ chẩn đoán, chuyển thông tin khi có sự kiện xảy ra.

    . Lưu và Khôi phục Tốc độ Tối đa
        . Thành phần phần mềm khối NV (NV Block software component) tạo NV Block cho ứng dụng để lưu tốc độ tối đa.
        . NV Block truyền dữ liệu đến NVM manager của phần mềm cơ bản để lưu vào bộ nhớ không bay hơi.
        . Trong quá trình khởi động lại, NVM manager khôi phục dữ liệu tốc độ từ bộ nhớ ngoài và chuyển xuống lớp ứng dụng thông qua NV Block.

    . Tổng kết
        . Thành phần phần mềm ứng dụng: Tính toán và xử lý logic chính.
        . Thành phần phần mềm cảm biến/thiết bị chấp hành: Chuyển đổi và tính toán dữ liệu cảm biến.
        . Thành phần phần mềm trừu tượng hóa ECU: Đọc chân IO và tính toán xung nhịp.
        . Thành phần phần mềm tham số: Cung cấp tham số hiệu chỉnh.
        . Trình điều khiển thiết bị phức tạp: Thực hiện các tác vụ thời gian quan trọng.
        . Thành phần phần mềm dịch vụ: Ghi lỗi chẩn đoán.
        . Thành phần phần mềm khối NV: Lưu và khôi phục dữ liệu không bay hơi.

    . Trong quá trình đào tạo tiếp theo, sẽ sử dụng cùng ví dụ này để tìm hiểu sâu về các cơ chế giao tiếp mà Autosar cung cấp.



